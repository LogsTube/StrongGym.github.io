<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strong Gym | Admin</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&family=Teko:wght@500;700&display=swap"
        rel="stylesheet">
    <script src="script.js" defer></script>
    <style>
        .admin-section {
            min-height: 80vh;
            padding-top: 120px;
        }

        .login-box {
            max-width: 400px;
            margin: 0 auto;
            background: #111;
            padding: 40px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #aaa;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            background: #050505;
            border: 1px solid #333;
            color: white;
            border-radius: 4px;
            font-family: 'Outfit', sans-serif;
        }

        .dashboard-grid {
            display: grid;
            gap: 40px;
        }

        .product-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .product-table th,
        .product-table td {
            text-align: left;
            padding: 15px;
            border-bottom: 1px solid #222;
        }

        .product-table th {
            color: var(--primary);
            font-family: 'Teko', sans-serif;
            font-size: 1.2rem;
        }

        .action-btn {
            padding: 5px 10px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-right: 5px;
        }

        .btn-delete {
            background: #ff2a2a;
            color: white;
        }

        .btn-edit {
            background: #222;
            color: white;
            border: 1px solid #444;
        }

        #add-product-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #111;
            padding: 30px;
            border-radius: 12px;
            width: 500px;
            border: 1px solid var(--primary);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
    </style>
</head>

<body>
    <header id="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo">STRONG <span class="accent">ADMIN</span></a>
            <nav>
                <ul class="nav-links">
                    <li><a href="index.html">Ver Sitio Web</a></li>
                    <li><a href="#" onclick="App.logout()">Cerrar Sesión</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Auth Section -->
    <section id="login-view" class="admin-section container">
        <div class="login-box">
            <h2 id="auth-title" style="text-align: center; margin-bottom: 30px;">MI <span class="accent">CUENTA</span>
            </h2>

            <!-- Toggle Buttons -->
            <div style="display: flex; margin-bottom: 20px; border-bottom: 1px solid #333;">
                <button type="button" id="tab-login" class="action-btn"
                    style="flex: 1; background: transparent; color: white; border-bottom: 2px solid var(--primary); border-radius: 0;"
                    onclick="switchAuth('login')">INICIAR SESIÓN</button>
                <button type="button" id="tab-register" class="action-btn"
                    style="flex: 1; background: transparent; color: #666; border-radius: 0;"
                    onclick="switchAuth('register')">REGISTRARSE</button>
            </div>

            <!-- Login Form -->
            <form id="login-form">
                <div class="form-group">
                    <label>Usuario</label>
                    <input type="text" id="username" placeholder="Usuario">
                </div>
                <div class="form-group">
                    <label>Contraseña</label>
                    <input type="password" id="password" placeholder="Contraseña">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ENTRAR</button>
            </form>

            <!-- Register Form -->
            <form id="register-form" style="display: none;">
                <div class="form-group">
                    <label>Nuevo Usuario</label>
                    <input type="text" id="reg-username" required placeholder="Elige un nombre de usuario">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="reg-email" required placeholder="tu@email.com">
                </div>
                <div class="form-group">
                    <label>Contraseña</label>
                    <input type="password" id="reg-password" required placeholder="Crea una contraseña">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">CREAR CUENTA</button>
            </form>
        </div>
    </section>

    <!-- Dashboard Section -->
    <section id="dashboard-view" class="admin-section container" style="display: none;">
        <div class="admin-header">
            <h2>PANEL DE <span class="accent">CONTROL</span></h2>
            <button class="btn btn-outline" onclick="App.logout()">Cerrar Sesión</button>
        </div>

        <!-- Tabs -->
        <div style="display: flex; gap: 20px; margin-bottom: 30px; border-bottom: 1px solid #333;">
            <button class="action-btn" onclick="switchAdminTab('products')" id="tab-products"
                style="background:transparent; color:#fff; border-bottom:2px solid var(--primary); border-radius:0;">PRODUCTOS</button>
            <button class="action-btn" onclick="switchAdminTab('orders')" id="tab-orders"
                style="background:transparent; color:#666; border-radius:0;">VENTAS (PEDIDOS)</button>
            <button class="action-btn" onclick="switchAdminTab('promotions')" id="tab-promotions"
                style="background:transparent; color:#666; border-radius:0;">PROMOCIONES</button>
        </div>

        <!-- Products View -->
        <div id="view-products">
            <div style="display: flex; justify-content: flex-end; margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="openModal()">+ NUEVO PRODUCTO</button>
            </div>
            <div style="overflow-x: auto;">
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>IMG</th>
                            <th>NOMBRE</th>
                            <th>CATEGORÍA</th>
                            <th>PRECIO</th>
                            <th>ACCIONES</th>
                        </tr>
                    </thead>
                    <tbody id="admin-product-list">
                        <!-- JS Injected -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Orders View -->
        <div id="view-orders" style="display: none;">
            <div style="overflow-x: auto;">
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>ID PEDIDO</th>
                            <th>FECHA</th>
                            <th>CLIENTE</th>
                            <th>TOTAL</th>
                            <th>MÉTODO</th>
                            <th>ESTADO</th>
                            <th>DETALLES</th>
                        </tr>
                    </thead>
                    <tbody id="admin-order-list">
                        <!-- JS Injected -->
                    </tbody>
                </table>
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn btn-outline" style="border-color: #ff2a2a; color: #ff2a2a;"
                        onclick="clearAllOrders()">VACIAR PEDIDOS</button>
                </div>
            </div>
        </div>

        <!-- Promotions View -->
        <div id="view-promotions" style="display: none;">
            <div style="display: flex; justify-content: flex-end; margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="openPromoModal()">+ NUEVA PROMOCIÓN</button>
            </div>
            <div style="overflow-x: auto;">
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>IMG</th>
                            <th>TÍTULO</th>
                            <th>PRECIO</th>
                            <th>CÓDIGO</th>
                            <th>ESTADO</th>
                            <th>ACCIONES</th>
                        </tr>
                    </thead>
                    <tbody id="admin-promo-list">
                        <!-- JS Injected -->
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Order Details Modal -->
    <div id="order-details-modal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center;">
        <div class="modal-content" style="max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px;">
                <h3 style="margin: 0; color: white;">DETALLES DEL <span class="accent">PEDIDO</span></h3>
                <button type="button" onclick="closeOrderModal()"
                    style="background: none; border: none; color: #fff; font-size: 2rem; cursor: pointer; line-height: 1;">&times;</button>
            </div>
            <div id="order-details-content" style="color: #ddd;">
                <!-- Content injected here -->
            </div>
            <div style="margin-top: 20px; text-align: right; border-top: 1px solid #333; padding-top: 20px;">
                <button type="button" class="btn btn-secondary" onclick="closeOrderModal()">CERRAR</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="add-product-modal">
        <div class="modal-content">
            <h3 id="modal-title" style="margin-bottom: 20px;">AÑADIR PRODUCTO</h3>
            <form id="product-form">
                <div class="form-group">
                    <label>Nombre del Producto</label>
                    <input type="text" id="p-name" required>
                </div>
                <div class="form-group">
                    <label>Categoría</label>
                    <select id="p-category">
                        <option value="proteinas">Proteína</option>
                        <option value="creatinas">Creatina</option>
                        <option value="preentrenos">Pre-entreno</option>
                        <option value="vitaminas">Vitaminas</option>
                        <option value="accesorios">Accesorios</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Precio ($)</label>
                    <input type="number" id="p-price" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="p-desc" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Etiqueta (Opcional)</label>
                    <input type="text" id="p-badge" placeholder="EJ: NUEVO">
                </div>
                <div class="form-group">
                    <label>Imagen del Producto</label>
                    <input type="file" id="p-image-file" accept="image/*" style="padding: 10px; background: #222;">
                    <small style="color: #666; margin-top: 5px; display: block;">Sube una imagen desde tu PC</small>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">GUARDAR</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">CANCELAR</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Promotion Modal -->
    <div id="add-promo-modal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center;">
        <div class="modal-content">
            <h3 id="promo-modal-title" style="margin-bottom: 20px;">CREAR PROMOCIÓN</h3>
            <form id="promo-form">
                <div class="form-group">
                    <label>Título</label>
                    <input type="text" id="pr-title" required placeholder="Ej: 2x1 en Proteínas">
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="pr-desc" rows="3" required placeholder="Detalles de la promo"></textarea>
                </div>
                <div class="form-group">
                    <label>Precio Oferta ($)</label>
                    <input type="number" id="pr-price" required step="0.01">
                </div>
                <div class="form-group">
                    <label>Código (Opcional)</label>
                    <input type="text" id="pr-code" placeholder="Ej: VERANO2026">
                </div>
                <div class="form-group">
                    <label>Imagen</label>
                    <input type="file" id="pr-image-file" accept="image/*" style="padding: 10px; background: #222;">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">GUARDAR</button>
                    <button type="button" class="btn btn-secondary" onclick="closePromoModal()">CANCELAR</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Admin specific logic
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const loginView = document.getElementById('login-view');
            const dashView = document.getElementById('dashboard-view');

            // Check auth
            if (App.isAdmin()) {
                loginView.style.display = 'none';
                dashView.style.display = 'block';
                dashView.style.display = 'block';
                renderAdminTable();
                renderOrdersTable();
                renderPromoTable();
            } else if (App.getCurrentUser()) {
                // If logged in as user but in admin page, redirect home if not admin
                window.location.href = 'index.html';
            }

            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const u = document.getElementById('username').value;
                const p = document.getElementById('password').value;

                const result = App.login(u, p);
                if (result.success) {
                    if (result.role === 'admin') {
                        window.location.reload();
                    } else {
                        window.location.href = 'index.html';
                    }
                } else {
                    alert(result.message || 'Credenciales incorrectas');
                }
            });

            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const u = document.getElementById('reg-username').value;
                const email = document.getElementById('reg-email').value;
                const p = document.getElementById('reg-password').value;

                const result = App.register(u, email, p);
                if (result.success) {
                    // Auto login
                    App.login(u, p);
                    alert('Cuenta creada exitosamente. Redirigiendo...');
                    window.location.href = 'index.html';
                } else {
                    alert(result.message);
                }
            });

            // Product Form
            // Product Form
            document.getElementById('product-form').addEventListener('submit', (e) => {
                e.preventDefault();

                const fileInput = document.getElementById('p-image-file');
                const file = fileInput.files[0];

                const saveProduct = (imgSrc) => {
                    const newProduct = {
                        name: document.getElementById('p-name').value,
                        category: document.getElementById('p-category').value,
                        price: parseFloat(document.getElementById('p-price').value),
                        desc: document.getElementById('p-desc').value,
                        badge: document.getElementById('p-badge').value,
                        image: imgSrc
                    };

                    App.addProduct(newProduct);
                    closeModal();
                    renderAdminTable();
                    alert('Producto guardado correctamente');
                };

                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (event) {
                        saveProduct(event.target.result);
                    };
                    reader.readAsDataURL(file);
                } else {
                    // Use a default placeholder if no image is uploaded
                    saveProduct('https://via.placeholder.com/300?text=Strong+Gym');
                }
            });

            // Promo Form
            document.getElementById('promo-form').addEventListener('submit', (e) => {
                e.preventDefault();

                const fileInput = document.getElementById('pr-image-file');
                const file = fileInput.files[0];

                const savePromo = (imgSrc) => {
                    const newPromo = {
                        title: document.getElementById('pr-title').value,
                        desc: document.getElementById('pr-desc').value,
                        code: document.getElementById('pr-code').value,
                        price: document.getElementById('pr-price').value,
                        image: imgSrc,
                        active: true
                    };
                    App.addPromotion(newPromo);
                    closePromoModal();
                    renderPromoTable();
                    alert('Promoción creada');
                };

                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (event) {
                        savePromo(event.target.result);
                    };
                    reader.readAsDataURL(file);
                } else {
                    savePromo('https://via.placeholder.com/400x200?text=Oferta');
                }
            });
        });

        function switchAuth(mode) {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const tabLogin = document.getElementById('tab-login');
            const tabRegister = document.getElementById('tab-register');

            if (mode === 'login') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
                tabLogin.style.borderBottom = '2px solid var(--primary)';
                tabLogin.style.color = 'white';
                tabRegister.style.borderBottom = 'none';
                tabRegister.style.color = '#666';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
                tabRegister.style.borderBottom = '2px solid var(--primary)';
                tabRegister.style.color = 'white';
                tabLogin.style.borderBottom = 'none';
                tabLogin.style.color = '#666';
            }
        }

        function switchAdminTab(tab) {
            const vProducts = document.getElementById('view-products');
            const vOrders = document.getElementById('view-orders');
            const vPromos = document.getElementById('view-promotions');
            const tProducts = document.getElementById('tab-products');
            const tOrders = document.getElementById('tab-orders');
            const tPromos = document.getElementById('tab-promotions');

            // Reset all
            vProducts.style.display = 'none';
            vOrders.style.display = 'none';
            vPromos.style.display = 'none';

            tProducts.style.borderBottom = 'none'; tProducts.style.color = '#666';
            tOrders.style.borderBottom = 'none'; tOrders.style.color = '#666';
            tPromos.style.borderBottom = 'none'; tPromos.style.color = '#666';

            if (tab === 'products') {
                vProducts.style.display = 'block';
                tProducts.style.borderBottom = '2px solid var(--primary)';
                tProducts.style.color = '#fff';
            } else if (tab === 'orders') {
                vOrders.style.display = 'block';
                tOrders.style.borderBottom = '2px solid var(--primary)';
                tOrders.style.color = '#fff';
                renderOrdersTable();
            } else if (tab === 'promotions') {
                vPromos.style.display = 'block';
                tPromos.style.borderBottom = '2px solid var(--primary)';
                tPromos.style.color = '#fff';
                renderPromoTable();
            }
        }

        function renderAdminTable() {
            const tbody = document.getElementById('admin-product-list');
            const products = App.getProducts();

            tbody.innerHTML = products.map(p => `
                <tr>
                    <td><img src="${p.image}" width="50" style="border-radius: 4px;"></td>
                    <td>${p.name}</td>
                    <td style="text-transform: capitalize;">${p.category}</td>
                    <td>$${p.price.toLocaleString('es-CO')}</td>
                    <td>
                        <button class="action-btn btn-delete" onclick="confirmDelete(${p.id})">ELIMINAR</button>
                    </td>
                </tr>
            `).join('');
        }

        function renderOrdersTable() {
            const tbody = document.getElementById('admin-order-list');
            const orders = App.getOrders();

            if (orders.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px; color:#666;">No hay ventas registradas aún.</td></tr>';
                return;
            }

            tbody.innerHTML = orders.map(o => {
                const orderData = encodeURIComponent(JSON.stringify(o));
                return `
                <tr>
                    <td style="font-family:monospace; color:var(--primary);">${o.id}</td>
                    <td>${new Date(o.date).toLocaleDateString()}</td>
                    <td>
                        ${o.customer.name}<br>
                        <small style="color:#666;">${o.customer.city}</small>
                    </td>
                    <td>$${o.total.toLocaleString('es-CO')}</td>
                    <td>${o.paymentMethod}</td>
                    <td>
                        <span style="color:${o.status === 'Completado' ? '#28a745' : '#ffc107'}; font-weight:bold;">
                            ${o.status}
                        </span>
                    </td>
                    <td>
                        <button class="action-btn btn-edit" onclick="showOrderDetails('${orderData}')">VER</button>
                        ${o.status === 'Pendiente' ?
                        `<button class="action-btn" style="background:#28a745; color:white; margin-left:5px;" onclick="confirmOrderPayment('${o.id}')">CONFIRMAR</button>`
                        : ''}
                    </td>
                </tr>
            `}).join('');
        }

        function showOrderDetails(orderJson) {
            const order = JSON.parse(decodeURIComponent(orderJson));
            const modal = document.getElementById('order-details-modal');
            const content = document.getElementById('order-details-content');

            content.innerHTML = `
                <div style="background: #050505; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #333;">
                    <p style="margin: 5px 0; display:flex; justify-content:space-between;"><strong style="color:var(--primary)">ID:</strong> <span>${order.id}</span></p>
                    <p style="margin: 5px 0; display:flex; justify-content:space-between;"><strong style="color:var(--primary)">FECHA:</strong> <span>${new Date(order.date).toLocaleString()}</span></p>
                    <p style="margin: 5px 0; display:flex; justify-content:space-between;"><strong style="color:var(--primary)">ESTADO:</strong> <span style="font-weight:bold; color:${order.status === 'Completado' ? '#28a745' : '#ffc107'}">${order.status}</span></p>
                </div>
                
                <h4 style="color: white; border-bottom: 1px solid #333; padding-bottom: 5px; margin-bottom: 10px; font-family:'Teko', sans-serif; letter-spacing:1px; font-size:1.2rem;">DATOS DEL CLIENTE</h4>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:20px;">
                    <div>
                        <small style="color:#666; display:block;">Nombre</small>
                        <div>${order.customer.name}</div>
                    </div>
                     <div>
                        <small style="color:#666; display:block;">Ciudad</small>
                        <div>${order.customer.city}</div>
                    </div>
                    <div>
                        <small style="color:#666; display:block;">Email</small>
                        <div style="word-break:break-all;">${order.customer.email}</div>
                    </div>
                    <div>
                        <small style="color:#666; display:block;">Teléfono</small>
                        <a href="tel:${order.customer.phone}" style="color:var(--primary);">${order.customer.phone}</a>
                    </div>
                    <div style="grid-column: 1 / -1;">
                        <small style="color:#666; display:block;">Dirección</small>
                        <div>${order.customer.address}</div>
                    </div>
                </div>
                
                <h4 style="color: white; border-bottom: 1px solid #333; padding-bottom: 5px; margin-bottom: 10px; margin-top: 20px; font-family:'Teko', sans-serif; letter-spacing:1px; font-size:1.2rem;">PRODUCTOS</h4>
                <div style="background: #050505; border-radius: 8px; overflow: hidden; border: 1px solid #333;">
                    ${order.items.map(i => `
                        <div style="display: flex; justify-content: space-between; align-items:center; padding: 12px; border-bottom: 1px solid #222;">
                            <div>
                                <span style="color: white; font-weight:bold;">${i.name}</span>
                                <div style="color:#888; font-size: 0.9rem;">Cantidad: ${i.quantity}</div>
                            </div>
                            <div style="font-weight: bold; color:var(--primary);">$${(i.price * i.quantity).toLocaleString('es-CO')}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div style="margin-top: 20px; text-align: right; font-size: 1.8rem; font-weight: 500; font-family:'Teko', sans-serif; color: var(--primary);">
                    TOTAL: $${order.total.toLocaleString('es-CO')}
                </div>
            `;

            modal.style.display = 'flex';
        }

        function closeOrderModal() {
            document.getElementById('order-details-modal').style.display = 'none';
        }

        function clearAllOrders() {
            if (confirm('¿ESTÁS SEGURO? Esto eliminará permanentemente todo el historial de pedidos.')) {
                App.clearOrders();
                renderOrdersTable();
                alert('Historial de pedidos vaciado.');
            }
        }

        function confirmOrderPayment(id) {
            if (confirm('¿Confirmar que el pago ha sido recibido?')) {
                if (App.confirmOrder(id)) {
                    renderOrdersTable();
                } else {
                    alert('Error al confirmar el pedido');
                }
            }
        }

        function confirmDelete(id) {
            if (confirm('¿Estás seguro de eliminar este producto?')) {
                App.deleteProduct(id);
                renderAdminTable();
            }
        }

        function renderPromoTable() {
            const tbody = document.getElementById('admin-promo-list');
            const promos = App.getPromotions();

            if (promos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">No hay promociones activas.</td></tr>';
                return;
            }

            tbody.innerHTML = promos.map(p => `
                <tr>
                    <td><img src="${p.image}" width="60" style="border-radius: 4px; object-fit: cover; aspect-ratio: 16/9;"></td>
                    <td>
                        <strong>${p.title}</strong><br>
                        <small style="color:#888">${p.desc.substring(0, 30)}...</small>
                    </td>
                    <td style="color: var(--primary); font-weight: bold;">$${parseFloat(p.price).toLocaleString('es-CO')}</td>
                    <td style="font-family:monospace; color:#ccc; letter-spacing:1px;">${p.code || '-'}</td>
                    <td>
                        <span style="color:${p.active ? '#28a745' : '#666'}; font-weight:bold;">
                            ${p.active ? 'ACTIVA' : 'INACTIVA'}
                        </span>
                    </td>
                    <td>
                        <button class="action-btn" onclick="togglePromo(${p.id})">
                            ${p.active ? 'DESACTIVAR' : 'ACTIVAR'}
                        </button>
                        <button class="action-btn btn-delete" onclick="deletePromo(${p.id})">ELIMINAR</button>
                    </td>
                </tr >
            `).join('');
        }

        function togglePromo(id) {
            App.togglePromotionStatus(id);
            renderPromoTable();
        }

        function deletePromo(id) {
            if (confirm('¿Eliminar promoción?')) {
                App.deletePromotion(id);
                renderPromoTable();
            }
        }

        function openModal() {
            document.getElementById('add-product-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('add-product-modal').style.display = 'none';
            document.getElementById('product-form').reset();
        }

        function openPromoModal() {
            document.getElementById('add-promo-modal').style.display = 'flex';
        }

        function closePromoModal() {
            document.getElementById('add-promo-modal').style.display = 'none';
            document.getElementById('promo-form').reset();
        }
    </script>
</body>

</html>